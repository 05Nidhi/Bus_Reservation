
<!DOCTYPE html>
<html>
<head>
<style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
</head>
<body>

<%= form_tag searches_path, method: :get do %>
  <%= hidden_field_tag 'token', @token  %>
  source: <%= text_field_tag :source, @source %>
  destination: <%= text_field_tag :destination, @destination %>
  <%= submit_tag 'Search' %>
<% end %>



<h2>Bus list</h2>
<%if @current_user.type=="BusOwner" %>
    <%= button_to 'Create bus', buses_new_path(token:@token) %>
    <br>
<table>
  <%= source %>
  <tr>
    <th>Name</th>
    <th>Source</th>
    <th>Destination</th>
    <th>Bus registration number</th>
    <th>Available seats</th>
    <th>Bus photo</th>
  </tr>
  <% @bus.each do |bus| %>
    <tr>
      <td>
        <%=  bus.name %>
      <td>
        <%= bus.source %>
      </td>
      <td>
        <%= bus.destination %>
      </td>
      <td>
        <%= bus.bus_registration_number %>
      </td>
      <td>
        <%= bus.seat_numbers.where(seat_status:false).count %>
      </td>
      <td>
        <%= bus.bus_photo %>
      </td>
    </tr>
  <% end %>
</table>
<% else %>
<br>
<table>

  <tr>
    <th>Name</th>
    <th>Source</th>
    <th>Destination</th>
    <th>Bus registration number</th>
    <th>Available seats</th>
    <th>Bus photo</th>
  </tr>
  <% @bus.each do |bus| %>
    <tr>
      <td>
        <%=  bus.name %>
      <td>
        <%= bus.source %>
      </td>
      <td>
        <%= bus.destination %>
      </td>
      <td>
        <%= bus.bus_registration_number %>
      </td>
      <td>
        <%= bus.seat_numbers.where(seat_status:false).count %>
      </td>
      <td>
        <%= bus.bus_photo %>
      </td>
      <td>
        <% @id=bus.id %>
        <%= button_to 'Book', tickets_new_path(token:@token, bus_id:bus.id) %>
      </td>
    </tr>
  <% end %>
</table>
<% end %>

</body>
</html>

